package com.catfiz.svcpersistent;

import com.catfiz.service.CatfishService;
import com.catfiz.svcpersistent.TaskDatabaseExecutor.TaskDatabaseOperation;

public class CommonPersistentExecutorBase {
    private boolean mIsResumeProcess = false;
    private CommonMessageInfo mResumeDownloadData = null;

    protected void deleteTaskState(String str, boolean z) {
        CommonMessageInfo obtain = CommonMessageInfo.obtain();
        obtain.mKey = str;
        Runnable taskDatabaseExecutor = new TaskDatabaseExecutor(obtain, TaskDatabaseOperation.DELETE);
        if (z) {
            taskDatabaseExecutor.run();
        } else {
            getCatfishService().postToDBHandler(taskDatabaseExecutor);
        }
    }

    protected CatfishService getCatfishService() {
        return CatfishService.getServiceInstance();
    }

    protected CommonMessageInfo getResumeUploadData() {
        return this.mResumeDownloadData;
    }

    protected boolean isResumeProcess() {
        return this.mIsResumeProcess;
    }

    public void setResumeDownloadProcess(boolean z, CommonMessageInfo commonMessageInfo) {
        this.mIsResumeProcess = z;
        this.mResumeDownloadData = commonMessageInfo;
    }

    protected void updateTaskState(String str, String str2, int i, int i2, String str3, boolean z) {
        CommonMessageInfo obtain = CommonMessageInfo.obtain();
        if (this.mIsResumeProcess) {
            obtain.mTimeStamp = this.mResumeDownloadData.mTimeStamp;
        } else {
            obtain.mTimeStamp = System.currentTimeMillis();
        }
        obtain.mKey = str;
        obtain.mAdditionalData = str3;
        obtain.mMessageType = i;
        obtain.mMessageContext = i2;
        obtain.mRecipient = str2;
        Runnable taskDatabaseExecutor = new TaskDatabaseExecutor(obtain, TaskDatabaseOperation.STORE);
        if (z) {
            taskDatabaseExecutor.run();
        } else {
            getCatfishService().postToDBHandler(taskDatabaseExecutor);
        }
    }
}
