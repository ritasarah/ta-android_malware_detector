package com.catfiz.svcpersistent;

public class CommonMessageInfo {
    private static final int MAX_POOL_SIZE = 50;
    private static CommonMessageInfo sPool;
    private static int sPoolSize = 0;
    private static final Object sPoolSync = new Object();
    public String mAdditionalData;
    public String mKey;
    public int mMessageContext;
    public int mMessageType;
    public String mRecipient;
    public long mTimeStamp;
    CommonMessageInfo next;

    public enum MessageContext {
        PRIVATE_MESSAGE,
        POOL_MESSAGE,
        STATUS_COMMENT_MESSAGE,
        NIC_MESSAGE
    }

    public static CommonMessageInfo obtain() {
        synchronized (sPoolSync) {
            if (sPool != null) {
                CommonMessageInfo commonMessageInfo = sPool;
                sPool = commonMessageInfo.next;
                commonMessageInfo.next = null;
                sPoolSize--;
                return commonMessageInfo;
            }
            return new CommonMessageInfo();
        }
    }

    void clearForRecycle() {
        this.mTimeStamp = 0;
        this.mKey = null;
        this.mAdditionalData = null;
        this.mMessageType = 0;
        this.mMessageContext = 0;
        this.mRecipient = null;
    }

    public void recycle() {
        clearForRecycle();
        synchronized (sPoolSync) {
            if (sPoolSize < MAX_POOL_SIZE) {
                this.next = sPool;
                sPool = this;
                sPoolSize++;
            }
        }
    }
}
