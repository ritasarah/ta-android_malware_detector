package com.catfiz.svcpersistent;

import com.catfiz.service.CatfishService;
import com.catfiz.svcpersistent.TaskDatabaseExecutor.TaskDatabaseOperation;

public class P2PUploadBase {
    private boolean mIsResumeProcess = false;
    private P2PUploadInfo mResumeUploadData = null;

    protected void deleteTaskState(String str, boolean z) {
        P2PUploadInfo obtain = P2PUploadInfo.obtain();
        obtain.mKey = str;
        Runnable taskDatabaseExecutor = new TaskDatabaseExecutor(obtain, TaskDatabaseOperation.DELETE);
        if (z) {
            taskDatabaseExecutor.run();
        } else {
            getCatfishService().postToDBHandler(taskDatabaseExecutor);
        }
    }

    protected CatfishService getCatfishService() {
        return CatfishService.getServiceInstance();
    }

    protected P2PUploadInfo getResumeUploadData() {
        return this.mResumeUploadData;
    }

    protected boolean isResumeProcess() {
        return this.mIsResumeProcess;
    }

    public void setResumeUploadProcess(boolean z, P2PUploadInfo p2PUploadInfo) {
        this.mIsResumeProcess = z;
        this.mResumeUploadData = p2PUploadInfo;
    }

    protected void updateTaskState(String str, String str2, String str3, int i, int i2, int i3, int i4, long j, String str4, boolean z) {
        P2PUploadInfo obtain = P2PUploadInfo.obtain();
        if (this.mIsResumeProcess) {
            obtain.mTimeStamp = this.mResumeUploadData.mTimeStamp;
        } else {
            obtain.mTimeStamp = System.currentTimeMillis();
        }
        obtain.mKey = str;
        obtain.mFilePath = str2;
        obtain.mDataSize = i;
        obtain.mBytestart = i2;
        obtain.mStreamType = i4;
        obtain.mRecipient = str3;
        obtain.mAdditionalData = str4;
        obtain.mChannelID = String.valueOf(j);
        obtain.mChunkOffset = i3;
        Runnable taskDatabaseExecutor = new TaskDatabaseExecutor(obtain, TaskDatabaseOperation.STORE);
        if (z) {
            taskDatabaseExecutor.run();
        } else {
            getCatfishService().postToDBHandler(taskDatabaseExecutor);
        }
    }
}
