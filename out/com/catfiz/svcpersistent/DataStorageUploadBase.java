package com.catfiz.svcpersistent;

import com.catfiz.service.CatfishService;
import com.catfiz.svcpersistent.TaskDatabaseExecutor.TaskDatabaseOperation;

public class DataStorageUploadBase {
    private boolean mIsResumeProcess = false;
    private DataStorageUploadInfo mResumeUploadData = null;

    protected void deleteTaskState(String str, boolean z) {
        DataStorageUploadInfo obtain = DataStorageUploadInfo.obtain();
        obtain.mKey = str;
        Runnable taskDatabaseExecutor = new TaskDatabaseExecutor(obtain, TaskDatabaseOperation.DELETE);
        if (z) {
            taskDatabaseExecutor.run();
        } else {
            getCatfishService().postToDBHandler(taskDatabaseExecutor);
        }
    }

    protected CatfishService getCatfishService() {
        return CatfishService.getServiceInstance();
    }

    protected DataStorageUploadInfo getResumeUploadData() {
        return this.mResumeUploadData;
    }

    protected boolean isResumeProcess() {
        return this.mIsResumeProcess;
    }

    public void setResumeUploadProcess(boolean z, DataStorageUploadInfo dataStorageUploadInfo) {
        this.mIsResumeProcess = z;
        this.mResumeUploadData = dataStorageUploadInfo;
    }

    protected void updateTaskState(String str, String str2, int i, int i2, int i3, String str3, boolean z) {
        DataStorageUploadInfo obtain = DataStorageUploadInfo.obtain();
        if (this.mIsResumeProcess) {
            obtain.mTimeStamp = this.mResumeUploadData.mTimeStamp;
        } else {
            obtain.mTimeStamp = System.currentTimeMillis();
        }
        obtain.mKey = str;
        obtain.mFilePath = str2;
        obtain.mDataSize = i;
        obtain.mBytestart = i2;
        obtain.mStreamType = i3;
        obtain.mAdditionalData = str3;
        Runnable taskDatabaseExecutor = new TaskDatabaseExecutor(obtain, TaskDatabaseOperation.STORE);
        if (z) {
            taskDatabaseExecutor.run();
        } else {
            getCatfishService().postToDBHandler(taskDatabaseExecutor);
        }
    }
}
