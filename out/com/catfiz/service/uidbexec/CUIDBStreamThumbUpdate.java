package com.catfiz.service.uidbexec;

import com.catfiz.pool.PoolDataStorage;
import com.catfiz.service.CatfishDataStorage;
import com.catfiz.service.ICatfishClientInterface;
import com.catfiz.service.uiresponse.CUIResponseExecutor;
import com.catfiz.util.Log;

public class CUIDBStreamThumbUpdate extends CUIDatabaseExecutorBase {
    private static final String TAG = "CUIDBStreamThumbUpdate";
    private String mFizzlink = null;
    private int mStatus = 0;

    public class CUIStreamThumbUpdateResponse extends CUIResponseExecutor {
        private String mFizzlink = null;
        private int mStatus = 0;

        public CUIStreamThumbUpdateResponse(ICatfishClientInterface iCatfishClientInterface, String str, int i) {
            super(iCatfishClientInterface);
            this.mFizzlink = str;
            this.mStatus = i;
        }

        public void run() {
            if (this.ifselfclient != null && !this.ifselfclient.isFinish()) {
                Log.d(CUIDBStreamThumbUpdate.TAG, "UPDATE STREAM THUMBNAIL: status: " + this.mStatus);
                Log.d(CUIDBStreamThumbUpdate.TAG, "UPDATE STREAM THUMBNAIL: fizzlink: " + this.mFizzlink);
                this.ifselfclient.onStreamHasThumbnail(this.mFizzlink, this.mStatus);
            }
        }
    }

    public CUIDBStreamThumbUpdate(ICatfishClientInterface iCatfishClientInterface, String str, int i) {
        super(iCatfishClientInterface);
        this.mStatus = i;
        Log.d(TAG, "update thumbnail get : " + i);
        this.mFizzlink = str;
    }

    public void run() {
        Log.d(TAG, "UPDATE STREAM THUMBNAIL: update DB");
        new CatfishDataStorage(getCatfishService()).updateStreamThumbnail(this.mFizzlink, this.mStatus);
        new PoolDataStorage(getCatfishService()).updateStreamThumbnail(this.mFizzlink, this.mStatus);
        postResponse(new CUIStreamThumbUpdateResponse(this.mIfclient, this.mFizzlink, this.mStatus));
    }
}
