package com.catfiz.service;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.telephony.TelephonyManager;
import com.catfiz.base.Constant;
import com.catfiz.intents.CatfishIntents;
import com.catfiz.util.Log;
import org.apache.commons.logging.impl.SimpleLog;

public class CatfishNetworkActivator extends BroadcastReceiver {
    private static final String TAG = "CatfishLibNetworkActivator";

    public void onReceive(Context context, Intent intent) {
        if (((TelephonyManager) context.getSystemService(Constant.PHONE)).getDeviceId() == null) {
            Log.e(TAG, "No device ID. ABORT");
            return;
        }
        NetworkInfo activeNetworkInfo = ((ConnectivityManager) context.getSystemService("connectivity")).getActiveNetworkInfo();
        if (activeNetworkInfo == null) {
            Log.d(TAG, "No Network. NOTIFY CATFISH_NO_NETWORK");
            context.startService(CatfishIntents.newIntent(context, CatfishService.CATFISH_NO_NETWORK));
        } else if (activeNetworkInfo.isConnected()) {
            Intent intent2 = null;
            switch (activeNetworkInfo.getType()) {
                case e.a /*0*/:
                    Log.d(TAG, "MOBILE. Start Service");
                    intent2 = CatfishIntents.newIntent(context, CatfishService.CATFISH_NETWORK_MOBILE_WAKEUP);
                    break;
                case e.b /*1*/:
                case SimpleLog.LOG_LEVEL_FATAL /*6*/:
                    Log.d(TAG, "WIFI. Start Service");
                    intent2 = CatfishIntents.newIntent(context, CatfishService.CATFISH_NETWORK_WIFI_WAKEUP);
                    break;
                default:
                    Log.d(TAG, "UNKNOWN. Service not started");
                    break;
            }
            if (intent2 != null) {
                Log.d(TAG, "Starting Service");
                context.startService(intent2);
                return;
            }
            Log.d(TAG, "Service not started");
        } else {
            Log.d(TAG, "No Connection. NOTIFY CATFISH_NO_CONNECTED_NETWORK");
            context.startService(CatfishIntents.newIntent(context, CatfishService.CATFISH_NO_CONNECTED_NETWORK));
        }
    }
}
