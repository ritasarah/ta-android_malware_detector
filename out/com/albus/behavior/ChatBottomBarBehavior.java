package com.albus.behavior;

import android.content.Context;
import android.support.design.widget.AppBarLayout;
import android.support.design.widget.AppBarLayout.OnOffsetChangedListener;
import android.support.design.widget.CoordinatorLayout;
import android.support.design.widget.CoordinatorLayout.Behavior;
import android.util.AttributeSet;
import android.view.View;
import android.view.animation.AccelerateInterpolator;
import com.albus.activity.ProfilesActivityCoba;
import com.albus.view.ChatsBottomBarView;
import com.catfiz.R;
import com.catfiz.util.Log;

public class ChatBottomBarBehavior extends Behavior {
    protected static final String TAG = "ChatBottomBarBehavior";
    private Context mContext;
    private boolean mFirstCreateBehavior = false;
    private int mToolbarHeight;

    public ChatBottomBarBehavior(Context context, AttributeSet attributeSet) {
        this.mToolbarHeight = (int) context.getResources().getDimension(R.dimen.actionbar);
        this.mContext = context;
    }

    public boolean layoutDependsOn(CoordinatorLayout coordinatorLayout, ChatsBottomBarView chatsBottomBarView, View view) {
        return view instanceof AppBarLayout;
    }

    public boolean onDependentViewChanged(CoordinatorLayout coordinatorLayout, final ChatsBottomBarView chatsBottomBarView, View view) {
        boolean onDependentViewChanged = super.onDependentViewChanged(coordinatorLayout, chatsBottomBarView, view);
        if (!(view instanceof AppBarLayout)) {
            return onDependentViewChanged;
        }
        ((AppBarLayout) view).addOnOffsetChangedListener(new OnOffsetChangedListener() {
            public void onOffsetChanged(AppBarLayout appBarLayout, int i) {
                if (i != 0) {
                    if (((ProfilesActivityCoba) ChatBottomBarBehavior.this.mContext).isBtnCommentClicked()) {
                        ((ProfilesActivityCoba) ChatBottomBarBehavior.this.mContext).setBtnCommentClicked(false);
                    }
                    if (chatsBottomBarView.getVisibility() == 4 || chatsBottomBarView.getVisibility() == 8) {
                        chatsBottomBarView.setVisibility(0);
                    }
                    chatsBottomBarView.animate().translationY(0.0f).alpha(1.0f).setDuration(100).setInterpolator(new AccelerateInterpolator());
                } else if (!((ProfilesActivityCoba) ChatBottomBarBehavior.this.mContext).isBtnCommentClicked()) {
                    Log.d(ChatBottomBarBehavior.TAG, "here");
                    chatsBottomBarView.animate().translationY((float) chatsBottomBarView.getHeight()).alpha(1.0f).setDuration(100).setInterpolator(new AccelerateInterpolator());
                }
            }
        });
        return true;
    }
}
