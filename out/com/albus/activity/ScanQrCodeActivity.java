package com.albus.activity;

import android.app.ActivityManager.TaskDescription;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentTransaction;
import android.view.Window;
import android.view.inputmethod.InputMethodManager;
import android.widget.EditText;
import com.albus.fragment.ScanQrCodeFragment;
import com.b.a.s;
import com.catfiz.R;
import com.catfiz.qrlib.DecoderActivity;
import com.catfiz.qrlib.result.ResultHandlerFactory;
import com.catfiz.util.Log;
import com.catfiz.util.Utils;
import org.apache.http.protocol.HTTP;

public class ScanQrCodeActivity extends DecoderActivity {
    private static final String TAG = "ScanQrCodeActivity";

    public void dismissKeyboard(EditText editText) {
        ((InputMethodManager) getSystemService("input_method")).hideSoftInputFromWindow(editText.getWindowToken(), 0);
    }

    public int getIdentity() {
        return getIntent().getIntExtra(HTTP.IDENTITY_CODING, -1);
    }

    public void handleDecode(s sVar, Bitmap bitmap) {
        drawResultPoints(bitmap, sVar);
        ((ScanQrCodeFragment) getSupportFragmentManager().findFragmentByTag(ScanQrCodeFragment.TAG)).handleDecodeInternally(sVar, ResultHandlerFactory.makeResultHandler(this, sVar), bitmap);
    }

    public void onBackPressed() {
        super.onBackPressed();
    }

    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        Log.d(TAG, "oncreate ScanQrCodeActivity");
        setContentView(R.layout.activity_view);
        if (Utils.hasLollipop()) {
            setTaskDescription(new TaskDescription(null, null, getResources().getColor(R.color.red)));
            Window window = getWindow();
            window.addFlags(RtlSpacingHelper.UNDEFINED);
            window.clearFlags(67108864);
            window.setStatusBarColor(getResources().getColor(R.color.black));
        }
        if (bundle == null) {
            Fragment newInstance = ScanQrCodeFragment.newInstance(getIntent().getExtras());
            FragmentTransaction beginTransaction = getSupportFragmentManager().beginTransaction();
            beginTransaction.replace(R.id.fl_view, newInstance, ScanQrCodeFragment.TAG);
            beginTransaction.setTransition(0);
            beginTransaction.commit();
        }
    }
}
