package com.albus.media;

import android.content.Context;
import android.graphics.Bitmap;
import com.catfiz.R;
import com.catfiz.media.CatfishPhotoStorage;
import java.lang.ref.WeakReference;

public class CroppedPhotoLoader extends ImageWorker {
    private WeakReference mLocalCache = null;

    public CroppedPhotoLoader(Context context) {
        super(context);
        setLoadingImage((int) R.drawable.df_pict);
        setDefaultBitmap((int) R.drawable.df_pict);
    }

    private Bitmap processBitmap(String str) {
        Bitmap photoThumbSized;
        try {
            photoThumbSized = CatfishPhotoStorage.getPhotoThumbSized(this.mContext, str);
        } catch (Exception e) {
            e.printStackTrace();
            photoThumbSized = null;
        }
        return photoThumbSized == null ? null : photoThumbSized;
    }

    public void clearLocalCache() {
        this.mLocalCache = null;
    }

    protected Bitmap getBitmapFromLocalCache(Object obj) {
        if (isInLocalCache(String.valueOf(obj))) {
            return this.mLocalCache != null ? (Bitmap) this.mLocalCache.get() : null;
        } else {
            clearLocalCache();
            return null;
        }
    }

    protected Bitmap processBitmap(Object obj) {
        return processBitmap(String.valueOf(obj));
    }

    protected void putBitmapInLocalCache(Object obj, Bitmap bitmap) {
        super.putBitmapInLocalCache(obj, bitmap);
        this.mLocalCache = new WeakReference(bitmap);
    }
}
